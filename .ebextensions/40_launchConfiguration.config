##############################################
#### Do not modify values below this line ####
##############################################
option_settings:
  ## Use the custom security group for the instances
  aws:autoscaling:launchconfiguration:
    IamInstanceProfile: aws-elasticbeanstalk-ec2-role
    EC2KeyName: "eb-cli"
    InstanceType: "t2-micro"
    SecurityGroups: 
    - { Ref : nodessecurityrsg }

Resources:
  ## Custom restricted security group for load balancer
  nodessecurityrsg:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: node security group
      VpcId: 
        Fn::GetOptionSetting: {OptionName: VPCId}
      SecurityGroupIngress:
      - IpProtocol: tcp
          FromPort: 5672
          ToPort: 5672
          SourceSecurityGroupId:
          Fn::GetAtt: [AWSEBSecurityGroup, GroupId]